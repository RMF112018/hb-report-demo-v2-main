---
description: 
globs: 
alwaysApply: false
---
# ğŸ§  Cursor Rules: Enhanced Staffing Suite (Executive, Project Executive & Project Manager)

---

## ğŸ¯ GOALS

- Provide executive, project executive, and project manager users a modern, interactive staff management utility
- Unify and clarify staffing navigation across all roles
- Replace legacy spreadsheet-style assignment panels with rich interactive Gantt charts
- Enhance SPCR (Staff Planning Change Request) workflows for all roles
- Integrate HBI Insights and labor cost analysis per role
- Ensure full light/dark theme support and responsive layout

---

## ğŸ§± GLOBAL LAYOUT EXPECTATIONS

- All staffing pages must adopt `app/dashboard/constraints-log/page.tsx` structure
- Layout should support:
  - Full-width scrollable data sections
  - Consistent page header and overview metrics panel
  - Responsive design
  - Keyboard-accessible interactions
  - Unified tab or toggle UX across roles

---

## ğŸ§‘â€ğŸ’¼ EXECUTIVE STAFFING PAGE

### ğŸ§© Structure & Panels
- Replace existing â€œStaff Managementâ€ panel with:
  - `InteractiveStaffingGantt.tsx`
  - Drag-and-drop staff assignment rows per project
  - Filter, sort by: project, employee, role, dates
  - Annotate assignments inline (reason, justification)
  - Export to PDF and Excel using shared export utilities

### ğŸ’° Overview Metrics Panel
- Labor cost summary = Î£(`laborRate + burden`) per assignment
- Inflow comparison = Î£ contract payments for assigned staffâ€™s projects
- Must support filters by:
  - Date range
  - Project(s)
  - Role(s)

### ğŸ§  EnhancedHBIInsights
- Integrate `EnhancedHBIInsights.tsx` with staffing focus
- Display proprietary guidance on:
  - Over/under allocation
  - Potential conflict detection
  - Staff planning trends

---

## ğŸ‘” PROJECT EXECUTIVE STAFFING PAGE

### ğŸš§ Navigation Simplification
- Consolidate the two rows of tabs into a single, clean navigation method
- Use one of:
  - Select dropdown (project-level vs portfolio view)
  - Sidebar navigation between assigned projects

### ğŸ“Š Gantt Chart
- Same component (`InteractiveStaffingGantt.tsx`) used in view-only mode
- Auto-filtered to projects assigned to the Project Executive
- No editing or reassignment features

### ğŸ’µ Labor Metrics
- Show labor costs vs inflows only for assigned projects
- Add filter down to a single project level

---

## ğŸ‘· PROJECT MANAGER STAFFING PAGE

### ğŸ” Layout & Role Clarity
- Align with unified `constraints-log` layout
- Ensure staffing Gantt chart and SPCR tools are integrated
- All elements must support dark and light themes

### ğŸ“Š Gantt Chart (Read-Only)
- Embed `InteractiveStaffingGantt.tsx` filtered to project(s) assigned to the PM
- Read-only mode: visible only, no interaction

### ğŸ“ SPCR Panel Enhancements
- Use `SPCRCreatorPanel.tsx` (new) for initiating requests
- Display all SPCRs (Pending, Approved, Rejected) for current project by default
- Include intuitive form UX to:
  - Add position type, justification
  - Set requested start/end date
  - View live preview of impact (conflicts, load)
- Include comment and submission system
- Status badges and inline history

### ğŸ’µ Labor Metrics
- Labor cost vs contract inflow limited to current project
- Filterable by role, labor category

---

## ğŸ“© SPCR MANAGEMENT WORKFLOW

### ğŸ§ª Data Constraints (Mock Data)
- No more than 3â€“9 total SPCRs visible to Executive users
- For each Project Executive:
  - Max 1â€“3 Pending SPCRs at a time
  - Max 5 total per project lifecycle
  - ~50% of SPCRs approved historically

### ğŸ” Filtering Defaults
- **Executive users**:
  - Default: Approved
  - Filter toggle: Pending, Rejected
- **Project Executive users**:
  - Default: Pending
  - Filter toggle: Approved, Rejected
- **Project Manager users**:
  - Default: All SPCRs for current project (no filter)

---

## ğŸ§  INDUSTRY-LEADING DESIGN TARGETS

- Drag-and-drop Gantt interaction with animation + accessibility (Exec only)
- Shared timeline component (`StaffTimelineChart`) used across all views
- Overview metrics should support dynamic KPI widgets
- Export options consistent with other analytical modules (PDF + Excel)
- Role-based restrictions:
  - PM: Submit/view SPCRs, read-only Gantt
  - PE: Review/approve/reject SPCRs, view-only Gantt
  - Exec: Modify assignments, manage Gantt
- All UI fully Tailwind and shadcn/ui compliant

---

## ğŸ” COMPONENTS TO BUILD/UPDATE

- `InteractiveStaffingGantt.tsx`
- `StaffTimelineChart.tsx` (rendered inside Gantt)
- `StaffWorkloadHeatmap.tsx`
- `SPCRInboxPanel.tsx`
- `SPCRCreatorPanel.tsx`
- `LaborVsRevenuePanel.tsx`
- `useStaffingStore.ts` (manages local state and SPCRs)
- Updated SPCR mock dataset (`spcr.json`)

---

## ğŸ§ª MOCK DATA UPDATES REQUIRED

- Regenerate `spcr.json` to meet volume and approval constraints above
- All mock assignments and inflows must use real users + project IDs from `staffing.json` and `projects.json`
- Labor rates and burden should be realistic (from 2024 union/project averages or user-defined logic)

---

## ğŸ“ STORAGE

- Demo interactions allowed using `localStorage`
- SPCR creation, status changes, and comments must persist across page reloads
- Use shared `useLocalStorage()` logic as used in `productivity/store`

---

# END OF STAFFING ENHANCEMENT RULE SET
